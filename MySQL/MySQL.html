<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>yjt</title><meta name="description" content="这是我的第一个 VuePress 站点">
    <link rel="modulepreload" href="/assets/app.7b29c1df.js"><link rel="modulepreload" href="/assets/MySQL.html.72866ebd.js"><link rel="modulepreload" href="/assets/MySQL.html.79de7d7f.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/assets/style.e8e8fc80.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="https://vuejs.org/images/logo.png" alt="yjt"><span class="site-name can-hide">yjt</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="STL"><span class="title">STL</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="STL"><span class="title">STL</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/vector/vector.md" class="" aria-label="vector"><!--[--><!--]--> vector <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/yuanjiteng" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="STL"><span class="title">STL</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="STL"><span class="title">STL</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/vector/vector.md" class="" aria-label="vector"><!--[--><!--]--> vector <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/yuanjiteng" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading"> <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/MySQL/MySQL.html#mysql初级技术" class="router-link-active router-link-exact-active sidebar-item" aria-label="MySQL初级技术"><!--[--><!--]--> MySQL初级技术 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/MySQL/MySQL.html#sql-select使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="SQL SELECT使用"><!--[--><!--]--> SQL SELECT使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/MySQL/MySQL.html#ddl-dml-dcl基本使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="DDL/DML/DCL基本使用"><!--[--><!--]--> DDL/DML/DCL基本使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/MySQL/MySQL.html#其他数据库对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="其他数据库对象"><!--[--><!--]--> 其他数据库对象 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/MySQL/MySQL.html#mysql高级部分" class="router-link-active router-link-exact-active sidebar-item" aria-label="MySQL高级部分"><!--[--><!--]--> MySQL高级部分 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/MySQL/MySQL.html#面试问题" class="router-link-active router-link-exact-active sidebar-item" aria-label="面试问题"><!--[--><!--]--> 面试问题 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><p>[TOC]</p><p>参考自康师傅： <a href="https://www.bilibili.com/video/BV1iq4y1u7vj?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noopener noreferrer">MySQL数据库教程天花板，mysql安装到mysql高级，强！硬！_哔哩哔哩_bilibili<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="mysql初级技术" tabindex="-1"><a class="header-anchor" href="#mysql初级技术" aria-hidden="true">#</a> MySQL初级技术</h2><p>SQL基本语句</p><p>登录 <code>mysql -u root -p</code></p><p>导入数据 <code>source d:\mysqldb.sql</code></p><p><code>show databases|tables|</code> 显示数据库或者表</p><p><code>desc describe</code> 显示表结构</p><h3 id="sql-select使用" tabindex="-1"><a class="header-anchor" href="#sql-select使用" aria-hidden="true">#</a> SQL SELECT使用</h3><h4 id="基本语句" tabindex="-1"><a class="header-anchor" href="#基本语句" aria-hidden="true">#</a> <strong>基本语句</strong></h4><p><code>SELECT 1;</code> #没有任何子句</p><p><code>SELECT 9/2;</code> #没有任何子句</p><p>选择特定的列 <code>select from</code></p><p>选择并别名一个列， as 可以省略，别名可以双引号 <code>select last_name as name from employees;</code></p><p>去除重复行 distinct ,需要放到所有列名的前面，组合去重 <code>select distinc department_id, salary from employees</code></p><p>如果表中命名和保留字冲突 使用``修饰进行转义</p><p><code>select from where 过滤内容</code></p><p>select 语句中支持各种运算符和函数：</p><img src="/assets/sql1.66baa057.png" style="zoom:80%;"><img src="/assets/sql2.0222901d.png" style="zoom:80%;"><img src="/assets/sql3.9e7e3a6e.png" style="zoom:80%;"><img src="/assets/sql4.b6015277.png" style="zoom:80%;"><img src="/assets/sql5.1a6e0895.png" style="zoom:80%;"><p>其中各种运算符符号与C语言并无区别，额外注意：</p><p><code>&lt;=&gt; 和 =</code> 区别在于安全等于运算符可以处理null值，null=null 输出 0 null&lt;=&gt;null 输出1</p><p><code>&lt;&gt; 和 !=</code> 不等于运算符不能判断NULL值。如果两边的值有任意一个为NULL，则结果为NULL。</p><p><code>like运算符</code> 使用模糊匹配，使用的是通配符，但是和LInux讲中通配符表达不一致</p><p>% 匹配0个或者多个字符 相当于文件通配符* _ 匹配一个字符 相当于文件通配符？以及正则表达的.</p><p>此外 使用like运算符之后 就需要使用<code>‘ ’</code>将修饰通配符表达式，转义字符等，例如：</p><p><code>SELECT job_id FROM jobs WHERE job_id LIKE ‘IT$_%’ escape &#39;<!--vuepress-ssr-app-->#39;;</code></p><p><code>regexp 运算符</code> 正则表达式，其用法和linux正则表达式一样，例如</p><p><code>SELECT * FROM fruits WHERE f_name REGEXP &#39;^ba+&#39;;</code></p><h4 id="排序分页、多表查询" tabindex="-1"><a class="header-anchor" href="#排序分页、多表查询" aria-hidden="true">#</a> 排序分页、多表查询</h4><p><strong>使用order by 子句排序 默认 asc升序 desc降序</strong></p><p>单列排序案例：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT last_name, job_id, department_id, hire_date 
FROM employees 
ORDER BY hire_date DESC ;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>多列排序案例：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT last_name, department_id, salary
FROM employees 
ORDER BY department_id, salary DESC;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以使用不在select列表中的列排序，首先对第一列排序，然后对第二列排序</p><p>使用<code>limit</code> 进行分页 ，必须放置在where子句的最后，提升查询效率</p><p><code>LIMIT [位置偏移量,] 行数</code> 注意linux中head tail等命令分页使用 -n 例如 head a.txt -n 5</p><p><strong>多表查询：from多个表</strong></p><p>from中可以使用别名，如果使用则 on 以及where中都需要使用</p><p>笛卡尔积出现条件：省略多个表的连接条件（或关联条件）连接条件（或关联条件）无效 所有表中的所有行互相连接</p><p>避免方式：通过where子句增加连接条件,表中有相同列时候，增加表明前缀区分</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#案例：查询员工的姓名及其部门名称 
SELECT last_name, department_name 
FROM employees, departments 
WHERE employees.department_id = departments.department_id;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>此外，通常使用join on语句进行连接，比上述方式更加清楚，最长使用left方式</p><img src="/assets/joinon.1ad20921.png" style="zoom:80%;"><p>一般来说，多表连接相当于使用嵌套for循环，应该避免使用多次，控制表的数量</p><h4 id="单行、聚合函数、子查询" tabindex="-1"><a class="header-anchor" href="#单行、聚合函数、子查询" aria-hidden="true">#</a> 单行、聚合函数、子查询</h4><p><strong>单行函数</strong> 列举部分，不用背</p><img src="/assets/singlefunction.b8445c69.png" style="zoom:80%;"><img src="/assets/singlefunction2.2a550376.png" style="zoom:80%;"><img src="/assets/singlefunction3.71f2e12d.png" style="zoom:80%;"><img src="/assets/singlefunction4.1f255a0d.png" style="zoom:80%;"><img src="/assets/singlefunction5.58620f2a.png" style="zoom:80%;"><img src="/assets/singlefunction6.7a2f7947.png" style="zoom:80%;"><img src="/assets/singlefunction7.f5e0d013.png" style="zoom:80%;"><img src="/assets/singlefunction8.b8e2fbb8.png" style="zoom:80%;"><img src="/assets/singlefunction9.592f97fe.png" style="zoom:80%;"><img src="/assets/singlefunction10.647bcd54.png" style="zoom:80%;"><p><strong>聚合函数</strong> 比较重要</p><p><code>AVG SUM MAX MIN COUNT</code> 案例：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT AVG(salary), MAX(salary),MIN(salary), SUM(salary) 
FROM employees 
WHERE job_id LIKE &#39;%REP%&#39;;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>GROUP BY 列分组、统计分析函数、可以使用多个列分组 和order by 类似</code></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT column, group_function(column) 
FROM table 
[WHERE condition] 
[GROUP BY group_by_expression] 
[ORDER BY column];
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>having 子句 只能用于 使用了聚合函数的 分组过滤 </code></p><p>where不能用于聚合函数，出错案例：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT department_id, AVG(salary) 
FROM employees 
WHERE AVG(salary) &gt; 8000 
GROUP BY department_id;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>WHERE 先筛选数据再关联，执行效率高 不能使用分组中的计算函数进行筛选</p><p>HAVING 可以使用分组中的计算函数 在最后的结果集中进行筛选，执行效率较低</p><p>总结模板</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#方式2： 
SELECT ...,....,... 
FROM ... 
JOIN ... 
ON 多表的连接条件 
JOIN ... 
ON ... 
WHERE 不包含组函数的过滤条件 
AND/OR 不包含组函数的过滤条件 
GROUP BY ...,... 
HAVING 包含组函数的过滤条件 
ORDER BY ... ASC/DESC 
LIMIT ...,...
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>子查询</strong> select嵌套</p><p>谁的工资比Abel的高？</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#方式1：自连接 
SELECT e2.last_name,e2.salary 
FROM employees e1,employees e2 
WHERE e1.last_name = &#39;Abel&#39; 
AND e1.`salary` &lt; e2.`salary`
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#方式2：子查询 
SELECT last_name,salary FROM employees 
WHERE salary &gt; ( 
SELECT salary 
FROM employees 
WHERE last_name = &#39;Abel&#39; );
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>使用自连接更好，因为一般数据库系统对自连接做了优化，子查询类似于多了一步中间变量或者条件判断</p><p>相关子查询 和 不相关子查询</p><p>多行比较操作符</p><p>IN ANY ALL 案例：查询平均工资最低的部门id</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT department_id 
FROM employees 
GROUP BY department_id 
HAVING AVG(salary) &lt;= ALL ( 
    SELECT AVG(salary) avg_sal 
    FROM employees 
    GROUP BY department_id )
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>相关子查询</strong>，子查询中用到了外部主查询的表，案例：</p><p>查询员工中工资大于<strong>本部门平均工资</strong>的员工的last_name,salary和其department_id</p><img src="/assets/subselect.e334dc48.png" style="zoom:80%;"><p>计算平均工资，但是是本部门, 另外一种方式是在from中应用子查询 然后自连接，比较难以理解</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT last_name,salary,e1.department_id 
FROM employees e1,(SELECT department_id,AVG(salary) dept_avg_sal 
    FROM employees 
    GROUP BY department_id) e2 
WHERE e1.`department_id` = e2.department_id AND e2.dept_avg_sal &lt; e1.`salary`;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>order by 中使用子查询案例 查询员工的id,salary,按照department_name 排序(多表时候需要，否则不需要)</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SELECT employee_id,salary 
FROM employees e 
ORDER BY ( SELECT department_name 
    FROM departments d 
    WHERE e.`department_id` = d.`department_id` );
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>此外，关联子查询通常也配合exists 和 not exists使用 同一个表尽量用自连接 不同表使用相关</p><p>相关更新 相关删除等操作</p><h3 id="ddl-dml-dcl基本使用" tabindex="-1"><a class="header-anchor" href="#ddl-dml-dcl基本使用" aria-hidden="true">#</a> DDL/DML/DCL基本使用</h3><p>DDL（Data Definition Languages、数据定义语言），这些语句定义了不同的数据库、表、视图、索引等数据库对象，还可以用来创建、删除、修改数据库和数据表的结构。</p><p>主要的语句关键字包括 CREATE 、 DROP 、 ALTER 等。</p><p>DML（Data Manipulation Language、数据操作语言），用于添加、删除、更新和查询数据库记</p><p>录，并检查数据完整性。主要的语句关键字包括 INSERT 、 DELETE 、 UPDATE 、 SELECT 等。</p><p>DCL（Data Control Language、数据控制语言，用于定义数据库、表、字段、用户的访问权限和安全级别。</p><p>创建和管理数据库</p><img src="/assets/general_type.7b8ffe8c.png" style="zoom:80%;"><p><code>create database 数据库名字;</code></p><p><code>create database 数据库名 character set 字符集 比如dbk，utf-8</code></p><p><code>create database if not exists 数据库名;</code></p><p>使用数据库 <code>use 数据库名</code></p><p>修改数据库 alter 删除数据库 drop</p><p><strong>创建表</strong></p><p><code>create table if not exists 表名（</code></p><p><code>字段1，数据类型 [约束条件] [默认值]</code>，</p><p><code>字段2，数据类型 [约束条件] [默认值]</code>，</p><p><code>primary key(字段1)</code></p><p><code>）</code></p><p>可以将select 和创建表联合使用，例如：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>CREATE TABLE dept80 
AS
SELECT employee_id, last_name, salary*12 ANNSAL, hire_date FROM employees 
WHERE department_id = 80;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>修改表</strong></p><p>追加列</p><p><code>ALTER TABLE 表名 ADD 【COLUMN】 字段名 字段类型 【FIRST|AFTER 字段名】;</code></p><p>修改列 数据类型、长度、默认值和位置等</p><p><code>ALTER TABLE 表名 MODIFY 【COLUMN】 字段名1 字段类型 【DEFAULT 默认值】【FIRST|AFTER 字段名</code></p><p><code>2】;</code></p><p>重命名列</p><p><code>ALTER TABLE 表名 CHANGE 【column】 列名 新列名 新数据类型;</code></p><p>删除列</p><p><code>ALTER TABLE 表名 DROP 【COLUMN】字段名</code></p><p><strong>插入数据</strong></p><p>插入一条数据 <code>INSERT INTO 表名 VALUES (value1,value2,....)</code></p><p>同样可以和select联合使用</p><p><strong>更新数据</strong></p><p><code>update [] codition</code></p><p><strong>删除数据</strong> delete</p><p>表<strong>约束</strong>的四个方面：实体完整性 域完整性 引用完整性 用于自定义完整性</p><p>包括 各个约束的添加和删除机制</p><p>NOT NULL 非空约束，规定某个字段不能为空</p><p>UNIQUE 唯一约束，规定某个字段在整个表中是唯一的</p><p>PRIMARY KEY 主键(非空且唯一)约束</p><p>FOREIGN KEY 外键约束</p><p>CHECK 检查约束</p><p>DEFAULT 默认值约束</p><h3 id="其他数据库对象" tabindex="-1"><a class="header-anchor" href="#其他数据库对象" aria-hidden="true">#</a> 其他数据库对象</h3><p>了解基本对象</p><img src="/assets/view.62664e53.png"><p>视图：即部分表的可视化</p><h4 id="存储过程和函数" tabindex="-1"><a class="header-anchor" href="#存储过程和函数" aria-hidden="true">#</a> 存储过程和函数</h4><p>里面还包含 变量 循环 条件 游标（结果指针）等概念，不展开。</p><p>创建存储过程</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>CREATE PROCEDURE 存储过程名(IN|OUT|INOUT 参数名 参数类型,...)
[characteristics ...]
BEGIN
	存储过程体
END
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>调用存储过程</p><p><code>CALL 存储过程名(实参列表)</code></p><p>创建函数</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>CREATE FUNCTION 函数名(参数名 参数类型,...) RETURNS 返回值类型 
[characteristics ...] 
BEGIN
函数体 
#函数体中肯定有 RETURN 语句
END
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>调用函数</p><p><code>select 函数名(实参列表)</code></p><p>但是国内厂家不建议使用这两个封装性功能，因为难以调试，可移植性差 存储过程版本难以管理 不适合高并发</p><h4 id="触发器" tabindex="-1"><a class="header-anchor" href="#触发器" aria-hidden="true">#</a> 触发器</h4><p>为了实现关联表的同时操作，就像各种语言中的事件模式</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>CREATE TRIGGER 触发器名称 
{BEFORE|AFTER} {INSERT|UPDATE|DELETE} ON 表名 
FOR EACH ROW 
触发器执行的语句块;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>优点：保证数据的完整性 记录日志操作 数据合法性检查</p><p>缺点：可读性差、相关数据的编程会导致触发器出错</p><h2 id="mysql高级部分" tabindex="-1"><a class="header-anchor" href="#mysql高级部分" aria-hidden="true">#</a> MySQL高级部分</h2><p>sql底层原理</p><p>索引</p><p>当表中的数据量达到几十万甚至上百万的时候，SQL的查询花费时间会很长，导致业务超时，因此需要使用索引来加速SQL查询</p><p>由于索引也是需要存储索引文件的，因此对于索引的使用也会涉及I/O操作，如果创建过多的索引，使用不当，会造成SQL查询时候，进行大量的无用的磁盘IO操作，降低查询效率，因此掌握良好的索引创建原则非常重要。</p><p>架构</p><p>索引和调优</p><p>事务</p><p>日志和备份</p><p>掌握关键技术：</p><p>SQL编程(自定义函数、存储过程、触发器、定时任务)</p><p>数据库索引建立</p><p>SQL语句优化</p><p>数据库内部结构和原理</p><p>数据库的性能监控分析与系统优化</p><p>各种参数常量设定</p><p>数据库建模优化</p><p>主从复制</p><p>分布式架构搭建、垂直切割和水平切割</p><p>MyCat</p><p>数据迁移</p><p>容灾备份和恢复</p><p>对开源数据库进行二次开发</p><h2 id="面试问题" tabindex="-1"><a class="header-anchor" href="#面试问题" aria-hidden="true">#</a> 面试问题</h2><p>编程技巧：</p><p>每个学校答过题的用户平均答题数量情况？</p><p>每个：group by 可以按照学校分类（存在每个）</p><p>答过题的用户的平均答题数量： 计算每个学校答过题的用户数量 count(distinct(答题id)) 计算每个学校答题数量 count(id),然后除法</p><p>两个select联合使用采取 union 联合 （一般存在分别） union会去重 union all不去重</p><p>必须会的条件函数 if 和case （存在重命名内容 字段 用于select中）</p><p>语法</p><blockquote><p>Select device_id,if(university = ‘北京大学&#39;,’北京大学&#39;,’其他大学&#39;）</p></blockquote><blockquote><p>as university</p></blockquote><blockquote><p>From user_profile</p></blockquote><p>用于对于字段进行更改 增加判断</p><blockquote><p>Select</p></blockquote><blockquote><p>CASE</p></blockquote><blockquote><p>WHEN SCORE = &#39;A&#39; THEN &#39;优&#39;</p></blockquote><blockquote><p>WHEN SCORE = &#39;B&#39; THEN &#39;良&#39;</p></blockquote><blockquote><p>WHEN SCORE = &#39;C&#39; THEN ‘中&#39;</p></blockquote><blockquote><p>ELSE ‘不及格&#39;</p></blockquote><blockquote><p>END --注意这里需要加end作为结束</p></blockquote><p>后面也可以group by 他们自己</p><p>日期函数</p><p>将时间戳转换成日期函数</p><blockquote><p>select</p></blockquote><blockquote><p>from_unixtime(time,&#39;yyyy-MM-dd&#39;) as time</p></blockquote><blockquote><p>From question_practice_detail</p></blockquote><p>将日期函数转换为时间戳</p><blockquote><p>select</p></blockquote><blockquote><p>from_unixtime(&#39;2021-08-01&#39;,&#39;yyyy-MM-dd&#39;) as time</p></blockquote><p>年月日获取</p><p>分别为year(),month(),day()。</p><p>日期差计算</p><blockquote><p>select</p></blockquote><blockquote><p>datediff(&#39;2021-08–09&#39;,&#39;2021-08-01&#39;)</p></blockquote><p>data_sub和data_add函数计算开始如期之后增加或者减少几天之后的日期</p><blockquote><p><strong>select</strong></p></blockquote><blockquote><p><strong>date_sub(&#39;2021-08–09&#39;,interval 8 day)</strong></p></blockquote><blockquote><p>select</p></blockquote><blockquote><p>date_add(&#39;2021-08–01&#39;,interval 8 day)</p></blockquote><p>想不出来就重新建表，逻辑部分应该最好交个处理器实现</p><p>文本函数</p><p>length</p><p>concat</p><p>就是切片，不支持冒号 但是可以使用嵌套操作实现相关功能</p><p>substring_index</p><p>select SUBSTRING_INDEX(&#39;180,78kg&#39;,&#39;,&#39;,&#39;1&#39;) as height 按照关键字截取字段</p><p>如果count是正数，那么就是从左往右数，第N个分隔符的左边的所有内容 如果count是负数，那么就是从右往左数，第N个分隔符的右边的所有内容</p><p>再不行就直接使用like 搜索</p><p>instr 寻找子串出现的第一个位置</p><p>substring 截取 从1开始计数</p><p>select substring(‘bacda’,2)</p><p>select substring(‘bacda’,2,2)</p><p>窗口函数</p><p>row_number() over partition by</p><p>先分组再排序</p><p>row_number() over (partition by col1 order by col2)</p><p>使用案例：先分组后在分组内部排序 窗口函数</p><blockquote><p>Select device_id, university,gpa,</p></blockquote><blockquote><p>row_number() over (partition by university order by gpa desc) as</p></blockquote><blockquote><p>rank. - -desc代表降序排列</p></blockquote><blockquote><p>From user_profile</p></blockquote><p>每个再加上最 结果使用这种函数 计算一个rank 然后使用子查询</p><p><code>Select device_id,</code><code>university,</code><code>gpa</code><code>From (</code><code>Select device_id,</code><code>university,</code><code>gpa,</code><code>row_number() over(partition by university order by gpa) as rk</code><code>From user_profile</code><code>)a</code><code>where rk = 1</code></p><p>总结一下规律</p><p>每一个 group by distinct</p><p>平均 最大 最小 max</p><p>排序 order by</p><p>多次 查询 union</p><p>多表连接 join on</p><p>多次排序 子查询 from select （增加一个flag选项用于判断要不要）</p><p>每个最 子查询加上窗口函数</p><p>count if功能实现使用 count case( when then 1 end)</p><p>牛客第一层sql刷完。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: yuanjiteng@whu.edu.cn">yuanjiteng</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.7b29c1df.js" defer></script>
  </body>
</html>
